"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9659],{79659:(e,t,i)=>{i.r(t),i.d(t,{default:()=>v});var r=i(74848),a=i(16286),n=i(96540),l=i(33540);let s=l.default.div`
  #vimjs-canvas {
    image-rendering: pixelated;
  }

  #vimjs-container {
    height: 100%;
    width: 100%;
  }

  #vimjs-file {
    display: none;
  }

  #vimjs-font-test {
    position: absolute;
    visibility: hidden;
  }
`;var o=i(16602),u=i(8218),c=i(55650),m=i(41017),d=i(62104),f=i(48060),p=i(37e3),w=i(48287).Buffer;let v=({id:e})=>{let{closeWithTransition:t,processes:{[e]:i}}=(0,d.N)(),{readFile:l,updateFolder:v,writeFile:h}=(0,m.f)(),b=(0,o.A)(),{prependFileToTitle:$}=(0,c.A)(e),{libs:j=[],url:V=""}=i||{},[g,y]=(0,n.useState)([]),A=(0,n.useRef)(!1),M=(0,n.useCallback)(async()=>{let i=V||f.nB,[,...r]=i.split("/"),n="";1===r.length&&(n="/root"),window.VimWrapperModule={},await (0,p.aY)(j,!1,!!window.VimWrapperModule);let s=V?await l(i):w.from("");window.VimWrapperModule?.init?.({VIMJS_ALLOW_EXIT:!0,arguments:[`${n}${i}`],containerWindow:document.querySelector("#vimjs-container")?.closest("section"),memoryInitializerPrefixURL:"/Apps/Vim.js/",postRun:[()=>{A.current=!1,b(window.VimWrapperModule?.VimModule?.FS,"Vim")}],preRun:[()=>{let e="";[n,...r].forEach((t,i,{[i+1]:a})=>{a&&i+1!==r.length?(window.VimWrapperModule?.VimModule?.FS_createPath?.(e,a,!0,!0),e+=`/${a}`):e?window.VimWrapperModule?.VimModule?.FS_createDataFile?.(e,t,s,!0,!0):e=t})}],print:console.info,printErr:console.info,quitCallback:()=>t(e),writeCallback:e=>y(t=>[...t,{buffer:w.from(e),url:i}])}),$((0,a.basename)(i))},[t,e,j,b,$,l,V]);return(0,n.useEffect)(()=>{g.length>0&&([...g].forEach(({buffer:e,url:t})=>{h(t,e,!0),v((0,a.dirname)(t),(0,a.basename)(t))}),y([]))},[v,g,h]),(0,n.useEffect)(()=>(A.current||(A.current=!0,M()),()=>{!A&&window.VimWrapperModule?.VimModule?.asmLibraryArg?._vimjs_prepare_exit()&&window.VimWrapperModule?.VimModule?.exit?.()}),[M]),(0,r.jsxs)(s,{children:[(0,r.jsx)("div",{id:"vimjs-container",...(0,u.A)({id:e}),children:(0,r.jsx)("canvas",{id:"vimjs-canvas",onContextMenuCapture:p.CH})}),(0,r.jsx)("div",{id:"vimjs-font-test"})]})}},16602:(e,t,i)=>{i.d(t,{A:()=>n});var r=i(96540),a=i(41017);let n=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:i}=(0,a.f)(),n=(0,r.useRef)();return(0,r.useEffect)(()=>()=>{if(n.current){let e=n.current;n.current="",t(e,!0).then(()=>i("/",void 0,e)).catch(()=>{})}},[t,i]),(0,r.useCallback)(async(t,r)=>{if(!t)return;let a="";try{a=await e(t,r)}catch{}a&&(i("/",a),n.current=a)},[e,i])}},8218:(e,t,i)=>{i.d(t,{A:()=>p});var r=i(16286),a=i(96540),n=i(51780),l=i(16091),s=i(13296),o=i(41017),u=i(62104),c=i(1364),m=i(48060),d=i(37e3),f=i(96119);let p=({callback:e,directory:t=m.Bn,id:i,onDragLeave:p,onDragOver:w,updatePositions:v})=>{let{url:h}=(0,u.N)(),b=(0,f.w)(),{iconPositions:$,sortOrders:j,setIconPositions:V}=(0,c.w)(),{exists:g,mkdirRecursive:y,updateFolder:A,writeFile:M}=(0,o.f)(),C=(0,a.useCallback)(async(e,t,a)=>{if(i){if(t){let n=(0,r.join)(m.Bn,e);if(await y(m.Bn),await M(n,t,!0))return a===s.z.UPDATE_URL&&h(i,n),A(m.Bn,e),(0,r.basename)(n)}else a===s.z.UPDATE_URL&&h(i,e)}return""},[i,y,A,h,M]),{openTransferDialog:_}=(0,n.A)();return{onDragLeave:p,onDragOver:e=>{w?.(e),(0,d.CH)(e)},onDrop:a=>{if(m.jj.has((0,d.uQ)(t)))return;if(v&&a.target instanceof HTMLElement){let{files:e,text:i}=(0,l.bn)(a);if(0===e.length&&""===i)return;(async()=>{let n={x:a.clientX,y:a.clientY},l=[];if(i){try{l=JSON.parse(i)}catch{}if(!Array.isArray(l))return;let[e]=l;if(!e||e.startsWith(t)&&(0,r.basename)(e)===(0,r.relative)(t,e))return;l=l.map(e=>(0,r.basename)(e))}else e instanceof FileList?l=[...e].map(e=>e.name):l=[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);l=await Promise.all(l.map(async e=>{let i=`${t}/${e}`;if(!$[i]||!await g(i))return e;let a=0;do a+=1,i=`${t}/${(0,r.basename)(e,(0,r.extname)(e))} (${a})${(0,r.extname)(e)}`;while($[i]&&await g(i));return(0,r.basename)(i)})),(0,d.$Y)(t,a.target,$,j,n,l,V,g)})()}let n="string"==typeof i;n&&!v&&t===m.Bn&&b.current[i]?.componentWindow?.focus(m.VD),(0,l.nX)(a,e||C,t,_,n)}}}},55650:(e,t,i)=>{i.d(t,{A:()=>s});var r=i(96540),a=i(62104),n=i(25573),l=i(48060);let s=e=>{let{title:t}=(0,a.N)(),[i]=e.split(l.QB),{title:s}=n.A[i]||{};return{appendFileToTitle:(0,r.useCallback)((i,r)=>{let a=i?` - ${i}${r?` ${l.g6}`:""}`:"";t(e,`${s}${a}`)},[e,s,t]),prependFileToTitle:(0,r.useCallback)((i,r,a)=>{let n=i?`${r?`${l.g6} `:""}${i}${a?" ":" - "}`:"";t(e,`${n}${s}`)},[e,s,t])}}}}]);